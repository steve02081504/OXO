<!DOCTYPE html>
<html data-theme="dark">

<head>
	<meta charset="UTF-8">
	<meta name="darkreader-lock">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>OXO</title>
	<link href="https://cdn.jsdelivr.net/npm/daisyui/themes.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
	<link href="https://cdn.jsdelivr.net/npm/daisyui/daisyui.css" rel="stylesheet" type="text/css" crossorigin="anonymous" />
	<script src="https://cdn.jsdelivr.net/npm/@unocss/runtime" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/iconify-icon/dist/iconify-icon.min.js"></script>

	<link rel="stylesheet" href="./index.css" />
</head>

<body class="flex flex-col min-h-screen bg-base-200 font-sans select-none">
	<div id="main-layout" class="flex flex-grow justify-center items-center w-full">
		<!-- Left AI Visualization -->
		<div id="ai-visualization-left" class="flex-1 flex justify-center items-center p-4 hidden">
			<!-- 模型可视化将被动态注入这里 -->
		</div>

		<div id="app" class="p-8 rounded-lg shadow-2xl bg-base-100 text-center w-full max-w-md">
			<header class="game-header">
				<h1>OXO</h1>
			</header>

			<main class="game-main">
				<!-- 模式选择界面 -->
				<section id="mode-selection" class="view-section">
					<div class="flex flex-wrap justify-center items-center gap-4">
						<button id="pvp-button" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-4xl" icon="line-md:emoji-smile"></iconify-icon>
							<span class="font-bold text-2xl">PVP</span>
						</button>
						<button id="pve-button" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-4xl" icon="line-md:computer"></iconify-icon>
							<span class="font-bold text-2xl">PVE</span>
						</button>
						<button id="eve-button" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-4xl" icon="line-md:monitor-mutlple"></iconify-icon>
							<span class="font-bold text-2xl">EVE</span>
						</button>
						<button id="auto-eve-button" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-4xl" icon="line-md:loading-twotone-loop"></iconify-icon>
							<span class="font-bold text-xm">AUTO-EVE</span>
						</button>
						<button id="replay-button" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-4xl" icon="line-md:play"></iconify-icon>
							<span class="font-bold text-2xl">Replay</span>
						</button>
					</div>
				</section>

				<!-- 游戏主界面 -->
				<section id="game-view" class="view-section hidden">
					<!-- 重构后的回合指示器与AI控制区域 -->
					<div id="turn-indicator" class="flex justify-around items-center gap-4 mb-4 h-16">
						<!-- X 玩家区域 -->
						<div id="player-control-x" class="flex flex-col items-center gap-2">
							<div id="turn-x" class="transition-all duration-300">
								<iconify-icon class="text-5xl" icon="line-md:close" style="color: #f87171;"></iconify-icon>
							</div>
							<!-- EVE模式下X的控制按钮, 默认隐藏 -->
							<div id="eve-controls-x" class="flex gap-2 hidden">
								<button id="import-x-button" class="btn btn-xs btn-ghost btn-circle"><iconify-icon icon="line-md:upload-outline" class="text-lg"></iconify-icon></button>
								<button id="export-x-button" class="btn btn-xs btn-ghost btn-circle"><iconify-icon icon="line-md:download-outline" class="text-lg"></iconify-icon></button>
							</div>
						</div>

						<!-- 回合数字显示 -->
						<div id="move-count-display" class="bg-base-300 text-base-content px-4 py-2 rounded-full text-lg font-bold z-10 shadow-md">0</div>

						<!-- O 玩家区域 -->
						<div id="player-control-o" class="flex flex-col items-center gap-2">
							<div id="turn-o" class="transition-all duration-300">
								<iconify-icon class="text-5xl" icon="line-md:circle" style="color: #60a5fa;"></iconify-icon>
							</div>
							<!-- EVE模式下O的控制按钮, 默认隐藏 -->
							<div id="eve-controls-o" class="flex gap-2 hidden">
								<button id="import-o-button" class="btn btn-xs btn-ghost btn-circle"><iconify-icon icon="line-md:upload-outline" class="text-lg"></iconify-icon></button>
								<button id="export-o-button" class="btn btn-xs btn-ghost btn-circle"><iconify-icon icon="line-md:download-outline" class="text-lg"></iconify-icon></button>
							</div>
						</div>
					</div>

					<div id="board-container" class="relative">
						<div id="game-board" class="grid grid-cols-3 gap-2 absolute inset-0" style="pointer-events: none;"></div>
						<svg id="winning-line-svg" class="absolute inset-0 w-full h-full pointer-events-none overflow-visible" viewBox="0 0 120 120"></svg>
					</div>

					<!-- PVP控制面板 -->
					<div id="pvp-controls" class="pvp-controls control-panel hidden">
						<div class="flex justify-between items-center">
							<div class="flex gap-2">
								<button id="exit-game-button" class="btn btn-sm btn-ghost btn-circle js-exit-game">
									<iconify-icon icon="line-md:logout" class="text-lg"></iconify-icon>
								</button>
							</div>
						</div>
					</div>

					<!-- PVE控制面板 -->
					<div id="pve-controls" class="pve-controls control-panel hidden">
						<div class="flex justify-between items-center mb-2">
							<div class="flex gap-2">
								<button id="import-pve-ai-button" class="btn btn-sm btn-ghost btn-circle"><iconify-icon icon="line-md:upload-outline" class="text-lg"></iconify-icon></button>
								<button id="exit-game-button-pve" class="btn btn-sm btn-ghost btn-circle js-exit-game">
									<iconify-icon icon="line-md:logout" class="text-lg"></iconify-icon>
								</button>
							</div>
						</div>
					</div>

					<!-- EVE控制面板 -->
					<div id="eve-controls" class="eve-controls control-panel hidden">
						<div class="flex justify-between items-center mb-2">
							<div class="flex gap-2">
								<button id="exit-game-button-eve" class="btn btn-sm btn-ghost btn-circle js-exit-game">
									<iconify-icon icon="line-md:logout" class="text-lg"></iconify-icon>
								</button>
							</div>
						</div>
					</div>

					<!-- Auto-EVE控制面板 -->
					<div id="auto-eve-controls" class="auto-eve-controls control-panel hidden">
						<div class="flex justify-between items-center">
							<div class="flex gap-2">
								<button id="import-network-button" class="btn btn-sm btn-ghost btn-circle"><iconify-icon icon="line-md:upload-outline" class="text-lg"></iconify-icon></button>
								<button id="export-best-button" class="btn btn-sm btn-ghost btn-circle"><iconify-icon icon="line-md:download-outline" class="text-lg"></iconify-icon></button>
								<button id="toggle-animation-button" class="btn btn-sm btn-ghost btn-circle"><iconify-icon icon="line-md:pause" class="text-lg"></iconify-icon></button>
								<button id="next-game-button" class="btn btn-sm btn-ghost btn-circle"><iconify-icon icon="line-md:chevron-double-right" class="text-lg"></iconify-icon></button>
								<button id="restart-auto-eve-button" class="btn btn-sm btn-ghost btn-circle"><iconify-icon icon="line-md:rotate-270" class="text-lg"></iconify-icon></button>
								<button id="exit-auto-eve-button" class="btn btn-sm btn-ghost btn-circle js-exit-game"><iconify-icon icon="line-md:logout" class="text-lg"></iconify-icon></button>
							</div>
						</div>
						<div class="progress-container">
							<div id="auto-eve-progress" class="progress-bar"></div>
						</div>
						<div class="stats stats-vertical lg:stats-horizontal shadow w-full mb-4">
							<div class="stat">
								<div class="stat-figure text-primary">
									<iconify-icon icon="line-md:account-multiple"></iconify-icon>
								</div>
								<div class="stat-title">Population</div>
								<div class="stat-value text-lg" id="population-size">0</div>
							</div>
							<div class="stat">
								<div class="stat-figure text-secondary">
									<iconify-icon icon="line-md:sword"></iconify-icon>
								</div>
								<div class="stat-title">Battles</div>
								<div class="stat-value text-lg" id="battle-count">0</div>
							</div>
							<div class="stat">
								<div class="stat-figure text-accent">
									<iconify-icon icon="line-md:trophy"></iconify-icon>
								</div>
								<div class="stat-title">Best Fitness</div>
								<div class="stat-value text-lg" id="best-fitness">0</div>
							</div>
							<div class="stat">
								<div class="stat-figure text-info">
									<iconify-icon icon="line-md:time-twotone-reverse"></iconify-icon>
								</div>
								<div class="stat-title">Generation</div>
								<div class="stat-value text-lg" id="generation-count">0</div>
							</div>
							<div class="stat">
								<div class="stat-figure text-warning">
									<iconify-icon icon="line-md:chart-line"></iconify-icon>
								</div>
								<div class="stat-title">Avg Fitness</div>
								<div class="stat-value text-lg" id="average-fitness">0</div>
							</div>
							<div class="stat">
								<div class="stat-figure text-success">
									<iconify-icon icon="line-md:brain"></iconify-icon>
								</div>
								<div class="stat-title">Network</div>
								<div class="stat-value text-sm">
									<div id="network-complexity-nodes">0</div>
									<div class="stat-desc">nodes</div>
								</div>
								<div class="stat-value text-sm">
									<div id="network-complexity-connections">0</div>
									<div class="stat-desc">connections</div>
								</div>
							</div>
							<div class="stat">
								<div class="stat-figure text-info">
									<iconify-icon icon="line-md:hourglass"></iconify-icon>
								</div>
								<div class="stat-title">Avg Game Length</div>
								<div class="stat-value text-lg" id="avg-game-length">0</div>
							</div>
						</div>
					</div>

					<div id="endgame-actions" class="flex justify-center gap-4 mt-6 h-16 opacity-0 transition-opacity duration-500 pointer-events-none">
						<button id="restart-button" class="btn btn-circle btn-lg">
							<iconify-icon class="text-2xl" icon="line-md:rotate-270"></iconify-icon>
						</button>
						<button id="home-button" class="btn btn-circle btn-lg js-exit-game">
							<iconify-icon class="text-2xl" icon="line-md:home-md"></iconify-icon>
						</button>
						<button id="export-history-button" class="btn btn-circle btn-lg hidden">
							<iconify-icon class="text-2xl" icon="line-md:download-loop"></iconify-icon>
						</button>
					</div>
				</section>

				<!-- 训练界面 -->
				<section id="training-view" class="view-section hidden">
					<h2>AI Training</h2>
					<div id="training-progress"></div>
				</section>
			</main>

			<dialog id="confirm_reset_modal" class="modal">
				<div class="modal-box bg-red-500 text-white text-center">
					<h3 class="font-bold text-lg flex items-center justify-center gap-2">
						<iconify-icon icon="line-md:alert" class="text-2xl"></iconify-icon>
					</h3>
					<div class="modal-action flex justify-center gap-4">
						<button id="confirm-reset-button" class="btn btn-error btn-circle">
							<iconify-icon icon="line-md:confirm"></iconify-icon>
						</button>
						<button id="cancel-reset-button" class="btn btn-ghost btn-circle">
							<iconify-icon icon="line-md:close"></iconify-icon>
						</button>
					</div>
				</div>
			</dialog>

			<!-- PVE选边Modal -->
			<dialog id="pve_side_modal" class="modal">
				<div class="modal-box text-center">
					<div class="flex justify-center items-center gap-8 py-4">
						<button id="pve-play-as-x" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-5xl" icon="line-md:close" style="color: #f87171;"></iconify-icon>
						</button>
						<button id="pve-play-as-o" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-5xl" icon="line-md:circle" style="color: #60a5fa;"></iconify-icon>
						</button>
					</div>
				</div>
			</dialog>

			<!-- Replay选择Modal -->
			<dialog id="replay_modal" class="modal">
				<div class="modal-box text-center">
					<div class="flex justify-center items-center gap-8 py-4">
						<button id="replay-last-game-modal-button" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-5xl" icon="line-md:play"></iconify-icon>
						</button>
						<button id="upload-replay-modal-button" class="btn btn-ghost h-32 w-32 rounded-full flex flex-col gap-2">
							<iconify-icon class="text-5xl" icon="line-md:upload-loop"></iconify-icon>
						</button>
					</div>
				</div>
			</dialog>
		</div>

		<!-- Right AI Visualization -->
		<div id="ai-visualization-right" class="flex-1 flex justify-center items-center p-4 hidden">
			<!-- 模型可视化将被动态注入这里 -->
		</div>
	</div>

	<script type="module" src="main.mjs"></script>
	<footer class="fixed bottom-4 w-full text-center text-xs text-gray-500">
		<p>Generated by <a class="link" href="https://github.com/steve02081504/fount" target="_blank">fount</a></p>
	</footer>
</body>

</html>
